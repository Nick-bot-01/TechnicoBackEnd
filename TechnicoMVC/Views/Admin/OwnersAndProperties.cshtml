@using TechnicoBackEnd.Auth
@using TechnicoBackEnd.DTOs;
@{
    ViewData["Title"] = "Properties and Owners Page";
}
@model List<PropertyDTO>
<h1>WELCOME ADMIN @LoginState.activeUser?.Name </h1>
<br>

@* @{
    var propertyDTO = (Model != null) ? Model.FirstOrDefault() : null;
    var ownerId = propertyDTO?.OwnerId;
} *@

@if (Model != null)
{
    foreach (var property in Model)
    {
        if (@property.PIN != null) @*maybe unnecessary*@
        {
            <div class="card" style="width: 18rem;">
                <div class="card-body">
                    <h5 class="card-title">@property.PIN.ToString()</h5>
                    <p class="card-text">@property.ConstructionYear</p>
                </div>
                <ul class="list-group list-group-flush">
                    <li class="list-group-item">@property.Address</li>
                    <li class="list-group-item">@property.PType</li>
                    <li class="list-group-item">@property.OwnerId</li>
                </ul>
                <div class="card-body">
                    @*use javascript and remove this comment*@
                    @* <a class="btn btn-primary" asp-area="" asp-controller="Admin" asp-action="PresentTargetOwnerDetailsCallback" asp-route-id="@property.OwnerId">Edit Owner</a> *@
                    <form asp-controller="Admin" asp-action="PresentTargetOwnerDetailsCallback" method="post" style="display: inline;">
                        <input type="hidden" name="ownerId" value="@property.OwnerId" />
                        <button type="submit" class="btn btn-primary">Edit Owner</button>
                    </form>
                    <a href="#" class="card-link">Update Property</a> @*implement*@
                    <a href="#" class="card-link">Delete Property</a> @*implement*@
                </div>
            </div>
        }
    }
}

<div class="container">
    <a class="btn btn-primary" asp-area="" asp-controller="Admin" asp-action="CreateOwner">Create Owner</a>
</div>

@* <div class="container">
    <a class="btn btn-primary" asp-area="" asp-controller="Admin" asp-action="EditOwner">Edit Owner</a>
</div> *@

<div class="container">
    <a class="btn btn-primary" asp-area="" asp-controller="Admin" asp-action="SearchOwner">Search User</a> @*add asp action*@
</div>

<div class="container">
    <a class="nav-link text-dark" asp-area="" asp-controller="Login" asp-action="Logout">[Logout]</a>
</div>